# Aè‚¡çŸ­çº¿äº¤æ˜“ç³»ç»Ÿ - é¡¹ç›®æ€»ç»“

## ğŸ“Œ é¡¹ç›®æ¦‚è§ˆ

**åç§°ï¼š** A-Share-Agentï¼ˆAè‚¡çŸ­çº¿æ™ºèƒ½äº¤æ˜“ç³»ç»Ÿï¼‰  
**ç±»å‹ï¼š** é‡åŒ–äº¤æ˜“ | å¼€æºå…è´¹  
**å‘¨æœŸï¼š** çŸ­çº¿ï¼ˆ1-5æ—¥ï¼‰  
**æˆæœ¬ï¼š** â‰¤500å…ƒï¼ˆå…¨æµç¨‹å¼€æºå…è´¹æ–¹æ¡ˆï¼‰  
**ç‰ˆæœ¬ï¼š** v0.1.0  
**çŠ¶æ€ï¼š** âœ… åŠŸèƒ½å®Œæ•´ | å¯ç›´æ¥ä½¿ç”¨

---

## ğŸ—ï¸ æ•´ä½“æ¶æ„

```
                    æ•°æ®å±‚ (Data)
                        â†“
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚    akshare è·å–Aè‚¡æ•°æ®   â”‚
           â”‚   ç¼“å­˜ (Parquet/CSV)    â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
              æƒ…ç»ªå±‚ (Emotion Analysis)
                        â†“
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  å¸‚åœºå®½åº¦ & æ¶¨è·Œæ¯”åˆ†æ  â”‚
           â”‚  52å‘¨é«˜ä½ & æ¶¨åœæŒ‡æ ‡    â”‚
           â”‚  Z-score åŠ æƒå¾—åˆ†       â”‚
           â”‚  å¸‚åœºæ€åŠ¿åˆ¤å®š (Bull/Bear)â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
              ä¿¡å·å±‚ (Signal Generation)
                        â†“
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  MA5 > MA20 å‡çº¿äº¤å‰    â”‚
           â”‚  åŠ¨é‡ç™¾åˆ†ä½ > 60%      â”‚
           â”‚  æ³¢åŠ¨ç™¾åˆ†ä½ < 80%      â”‚
           â”‚  æˆäº¤é‡ > 20æ—¥å‡å€¼     â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
            é£æ§å±‚ (Risk Management)
                        â†“
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  å¸‚åœºæ€åŠ¿è¿‡æ»¤ (ç†Šå¸‚æ‹’ç») â”‚
           â”‚  Top-K æ‰“åˆ†ç­›é€‰ (20ä¸ª)  â”‚
           â”‚  Sigmoid ä»“ä½ç¼©æ”¾       â”‚
           â”‚  æŒä»“æƒé‡è®¡ç®—           â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
           å›æµ‹éªŒè¯ & è®¢å•å¯¼å‡º
                        â†“
              CSV è®¢å•æ–‡ä»¶
           (å¯ç›´æ¥ç”¨äºäº¤æ˜“)
```

---

## ğŸ“‚ å®Œæ•´æ–‡ä»¶ç»“æ„

```
a-share-agent/                    # é¡¹ç›®æ ¹ç›®å½•
â”œâ”€â”€ README.md                      # å®Œæ•´æ–‡æ¡£ï¼ˆæ¨èé¦–å…ˆé˜…è¯»ï¼‰
â”œâ”€â”€ QUICKSTART.md                  # å¿«é€Ÿå¯åŠ¨æŒ‡å—ï¼ˆ5åˆ†é’Ÿä¸Šæ‰‹ï¼‰
â”œâ”€â”€ PROJECT_SUMMARY.md             # æœ¬æ–‡ä»¶
â”œâ”€â”€ requirements.txt               # ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ config_example.py              # é…ç½®æ¨¡æ¿ï¼ˆä¿å®ˆ/å¹³è¡¡/æ¿€è¿›æ–¹æ¡ˆï¼‰
â”œâ”€â”€ .gitignore                     # Gitå¿½ç•¥è§„åˆ™
â”‚
â”œâ”€â”€ data/                          # æ•°æ®ç›®å½•ï¼ˆç¼“å­˜/è¾“å‡ºï¼‰
â”‚   â”œâ”€â”€ market/
â”‚   â”‚   â””â”€â”€ breadth.parquet       # å¸‚åœºå®½åº¦æŒ‡æ ‡ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚   â””â”€â”€ orders/
â”‚       â””â”€â”€ orders_today.csv      # ä»Šæ—¥è®¢å•ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚
â”œâ”€â”€ src/                           # æ ¸å¿ƒæ¨¡å—åŒ…
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ dataio.py                 # æ•°æ®è·å–ä¸ç¼“å­˜å±‚
â”‚   â”‚   â”œâ”€â”€ get_universe()         # è·å–æµåŠ¨æ€§æ’åå‰Nä¸ª
â”‚   â”‚   â”œâ”€â”€ fetch_hist_qfq()       # è·å–å•åªè‚¡ç¥¨å†å²æ•°æ®
â”‚   â”‚   â”œâ”€â”€ fetch_panel()          # è·å–å¤šåªè‚¡ç¥¨é¢æ¿
â”‚   â”‚   â””â”€â”€ save/load_parquet()    # ç¼“å­˜ç®¡ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ breadth.py                # å¸‚åœºå®½åº¦ä¸æƒ…ç»ªå‘¨æœŸ
â”‚   â”‚   â”œâ”€â”€ compute_breadth()      # è®¡ç®—å¸‚åœºæŒ‡æ ‡
â”‚   â”‚   â””â”€â”€ build_breadth()        # æ„å»ºå®Œæ•´æ•°æ®é›†
â”‚   â”‚
â”‚   â”œâ”€â”€ signals.py                # é€‰è‚¡ä¿¡å·ä¸æŠ€æœ¯æ‰“åˆ†
â”‚   â”‚   â””â”€â”€ make_signals()         # ç”Ÿæˆ entries/exits/scores
â”‚   â”‚
â”‚   â”œâ”€â”€ risk.py                   # é£é™©ç®¡ç†ä¸ä»“ä½ç¼©æ”¾
â”‚   â”‚   â”œâ”€â”€ apply_regime_filter()  # å¸‚åœºæ€åŠ¿è¿‡æ»¤
â”‚   â”‚   â”œâ”€â”€ position_scale()       # åŠ¨æ€ä»“ä½ç¼©æ”¾
â”‚   â”‚   â””â”€â”€ position_size()        # è®¡ç®—æŒä»“æƒé‡
â”‚   â”‚
â”‚   â”œâ”€â”€ backtest.py               # ç»„åˆå›æµ‹å¼•æ“
â”‚   â”‚   â”œâ”€â”€ backtest_portfolio()   # vectorbt å›æµ‹
â”‚   â”‚   â””â”€â”€ simple_backtest()      # ç®€åŒ–ç‰ˆæœ¬ï¼ˆæ— ä¾èµ–ï¼‰
â”‚   â”‚
â”‚   â””â”€â”€ orders.py                 # è®¢å•ç”Ÿæˆä¸å¯¼å‡º
â”‚       â”œâ”€â”€ export_orders_today()  # å¯¼å‡ºä»Šæ—¥è®¢å•
â”‚       â””â”€â”€ export_orders_batch()  # æ‰¹é‡å¯¼å‡ºå¤šæ—¥
â”‚
â””â”€â”€ scripts/                       # å¯ç›´æ¥è¿è¡Œçš„è„šæœ¬
    â”œâ”€â”€ run_breadth.py            # [å¿…é¡»1] æ„å»ºå¸‚åœºå®½åº¦ï¼ˆ15:10ï¼‰
    â”œâ”€â”€ run_daily.py              # [å¿…é¡»2] æ—¥åº¦é€‰è‚¡ä¸è®¢å•ï¼ˆ15:20ï¼‰
    â””â”€â”€ backtest_analysis.py      # [å¯é€‰] å›æµ‹åˆ†æä¸å‚æ•°ä¼˜åŒ–
```

---

## ğŸ”„ æ ¸å¿ƒå·¥ä½œæµç¨‹

### **ç¬¬ä¸€é˜¶æ®µï¼šä¸€æ¬¡æ€§åˆå§‹åŒ–**

```bash
# é¦–æ¬¡è¿è¡Œï¼ˆè€—æ—¶10-30åˆ†é’Ÿï¼‰
python scripts/run_breadth.py

# è¾“å‡ºï¼šdata/market/breadth.parquet ï¼ˆçº¦200KBï¼ŒåŒ…å«2å¹´æ•°æ®ï¼‰
```

**å·¥ä½œå†…å®¹ï¼š**
1. è·å–Aè‚¡å‰100ä¸ªæµåŠ¨æ€§æœ€å¥½çš„è‚¡ç¥¨
2. è®¡ç®—2å¹´å†å²æ•°æ®çš„å¸‚åœºå®½åº¦ã€æ¶¨è·Œæ¯”ã€52å‘¨é«˜ä½ã€æ¶¨åœæŒ‡æ ‡
3. Z-scoreåŠ æƒç»„åˆ â†’ å®½åº¦å¾—åˆ†
4. EMAå¹³æ»‘ â†’ æƒ…ç»ªæ›²çº¿
5. åˆ¤å®šå¸‚åœºæ€åŠ¿ (Bull/Neutral/Bear)

---

### **ç¬¬äºŒé˜¶æ®µï¼šæ¯æ—¥å¾ªç¯**

```
äº¤æ˜“æ—¥ 15:10 â†’ è¿è¡Œ run_breadth.py
               â†“ 5åˆ†é’Ÿå
äº¤æ˜“æ—¥ 15:20 â†’ è¿è¡Œ run_daily.py
               â†“
è¾“å‡ºï¼šdata/orders_today.csv ï¼ˆäººå·¥æˆ–è‡ªåŠ¨æ‰§è¡Œï¼‰
```

**å·¥ä½œå†…å®¹ï¼š**

| æ­¥éª¤ | å‡½æ•° | è¾“å…¥ | è¾“å‡º |
|---|---|---|---|
| 1 | `make_signals()` | 100åªä»£ç +3å¹´å†å² | entries/exits/score |
| 2 | `apply_regime_filter()` | entries + breadth | ç†Šå¸‚è¿‡æ»¤åçš„signals |
| 3 | Top-Kç­›é€‰ | score + è¿‡æ»¤åsignals | å‰20ä¸ªæ ‡çš„ |
| 4 | `position_scale()` | breadth_score_ema | ä»“ä½ç¼©æ”¾å› å­ [20%-100%] |
| 5 | `export_orders_today()` | é€‰ä¸­æ ‡çš„ + æƒé‡ | CSVè®¢å•æ–‡ä»¶ |

---

## ğŸ“Š å…³é”®æŒ‡æ ‡è¯´æ˜

### **å¸‚åœºå®½åº¦æŒ‡æ ‡** (breadth.pyè¾“å‡º)

| æŒ‡æ ‡ | è®¡ç®—æ–¹å¼ | å«ä¹‰ |
|---|---|---|
| `up_count` | ä¸Šæ¶¨è‚¡æ•° | ç›´æ¥è®¡æ•° |
| `ad_ratio` | (up-down)/total | èŒƒå›´[-1, 1]ï¼Œ>0ä¸ºä¸Šå‡åŠ¨èƒ½ |
| `nh_ratio` | 52å‘¨åˆ›é«˜/æ€»æ•° | >30%ä¸ºå¼ºåŠ¿ï¼Œ<10%ä¸ºå¼±åŠ¿ |
| `zt_ratio` | æ¶¨åœè‚¡æ•°/æ€»æ•° | æç«¯æƒ…ç»ªæŒ‡æ ‡ |
| `breadth_score` | Z-scoreåŠ æƒ | æƒé‡ï¼š50% ad_ratio + 30% nh_ratio + 20% zt_ratio |
| `breadth_score_ema` | 5æ—¥EMAå¹³æ»‘ | [-3, 3]èŒƒå›´ï¼Œç”¨äºåˆ¤å®šå¸‚åœºæ€åŠ¿ |
| `regime` | åŒºé—´åˆ¤å®š | Bull (>0.5) / Neutral / Bear (<-0.5) |

### **é€‰è‚¡ä¿¡å·æŒ‡æ ‡** (signals.pyè¾“å‡º)

| æŒ‡æ ‡ | è®¡ç®—æ–¹å¼ | å…¥åœºè¦æ±‚ |
|---|---|---|
| `entries` | å¤šæ¡ä»¶AND | MA5>MA20 & åŠ¨é‡>60% & æ³¢åŠ¨<80% & æˆäº¤é‡æ”¾å¤§ |
| `exits` | å•æ¡ä»¶ | MA5 < MA20 |
| `score` | åŠ¨é‡ç™¾åˆ†ä½ - æ³¢åŠ¨ç™¾åˆ†ä½ | ç”¨äºTop-Kæ’åºï¼ŒèŒƒå›´[-1, 1] |

### **é£æ§æŒ‡æ ‡** (risk.pyè¾“å‡º)

| æŒ‡æ ‡ | è®¡ç®—æ–¹å¼ | èŒƒå›´ | è¯´æ˜ |
|---|---|---|---|
| `position_scale` | Sigmoid(breadth_score_ema) | [20%, 100%] | ä»“ä½ç¼©æ”¾ï¼ŒBullæ—¶100%ï¼ŒBearæ—¶20% |
| `max_positions` | æœ€å¤šæŒä»“æ•° | 20 | ç¡¬çº¦æŸ |
| `target_weight` | 1/æŒä»“æ•° Ã— ç¼©æ”¾å› å­ | [1%, 5%] | å•æ ‡çš„æƒé‡ |

---

## ğŸ’¡ æ ¸å¿ƒç®—æ³•åŸç†

### **1ï¸âƒ£ å¸‚åœºå®½åº¦å¾—åˆ†** (Breadth Score)

```
breadth_score = 0.5 Ã— Z-score(ad_ratio) 
              + 0.3 Ã— Z-score(nh_ratio - nl_ratio) 
              + 0.2 Ã— Z-score(zt_ratio)

å…¶ä¸­Z-score = (x - 252æ—¥å‡å€¼) / 252æ—¥æ ‡å‡†å·®ï¼Œclipåˆ°[-3, 3]
```

**è§£é‡Šï¼š** 
- ä¸­æ€§å¸‚åœºå‚ä¸åº¦ä½ â†’ ad_ratioä½ â†’ Z-scoreä½ â†’ breadth_scoreä½ 
- å¼ºåŠ¿å¸‚åœºä¸Šæ¶¨å®¶æ•°å¤š â†’ ad_ratioé«˜ + nh_ratioé«˜ â†’ breadth_scoreé«˜

### **2ï¸âƒ£ é€‰è‚¡æ‰“åˆ†** (Signal Score)

```
score = percentile_rank(momentum) - percentile_rank(volatility)

è¿™æ ·å¾—åˆ†ä¼šè‡ªåŠ¨å¤„ç†æç«¯å€¼ï¼Œé¿å…å•ä¸ªè‚¡ç¥¨å™ªéŸ³
```

**è§£é‡Šï¼š** åå¥½é«˜åŠ¨é‡ä½æ³¢åŠ¨çš„æ ‡çš„ï¼Œç¬¦åˆçŸ­çº¿"é¡ºåŠ¿è€Œä¸º"çš„é€»è¾‘

### **3ï¸âƒ£ ä»“ä½ç¼©æ”¾** (Position Scaling)

```
scale = Sigmoid(breadth_score_ema) = 1 / (1 + e^(-x))
      âˆˆ [0, 1]ï¼Œå†æ˜ å°„åˆ° [20%, 100%]

ç¼©æ”¾å› å­ = (0.2 + Sigmoid(score)).clip(0, 1)
```

**è§£é‡Šï¼š** 
- ç‰›å¸‚æƒ…ç»ªå¼º (score > 0.5) â†’ Sigmoid â‰ˆ 0.73 â†’ ç¼©æ”¾ â‰ˆ 93%
- ä¸­æ€§å¸‚åœº (score â‰ˆ 0) â†’ Sigmoid = 0.5 â†’ ç¼©æ”¾ â‰ˆ 70%
- ç†Šå¸‚æƒ…ç»ªå¼± (score < -0.5) â†’ æ•´ä½“æ‹’ç»äº¤æ˜“ (regime=Bear)

---

## ğŸ§ª å›æµ‹æ¡†æ¶

### **ä¸¤ç§å›æµ‹å¼•æ“**

1. **vectorbt å¼•æ“** (å¦‚æœ `pip install vectorbt` æˆåŠŸ)
   - å‘é‡åŒ–è®¡ç®—ï¼Œæ¯«ç§’çº§é€Ÿåº¦
   - è‡ªåŠ¨æ‰‹ç»­è´¹ã€æ»‘ç‚¹ã€å¤åˆ©è®¡ç®—
   - é€‚åˆå¤§è§„æ¨¡å‚æ•°ä¼˜åŒ–

2. **ç®€åŒ–å¼•æ“** (é»˜è®¤ï¼Œæ— ä¾èµ–)
   - æ‰‹å·¥æ—¥åº¦PnLè®¡ç®—
   - æ”¯æŒåŸºæœ¬æŒ‡æ ‡ï¼ˆå¹´åŒ–ã€å¤æ™®ã€æœ€å¤§å›æ’¤ï¼‰
   - é€‚åˆå¿«é€ŸéªŒè¯

### **è¾“å‡ºæŒ‡æ ‡**

```python
{
    'total_return': 0.25,           # æ€»æ”¶ç›Š 25%
    'annualized_return': 0.12,      # å¹´åŒ– 12%
    'sharpe': 1.05,                 # é£é™©è°ƒæ•´å â‰¥0.8ä¸ºä¼˜
    'max_drawdown': 0.15,           # æœ€å¤§å›æ’¤ 15% (åº”<20%)
    'win_rate': 0.52,               # èƒœç‡ 52%
    'trades': 125,                  # æ€»äº¤æ˜“æ•°
}
```

**è¯„ä»·æ ‡å‡†ï¼š**
- âœ… ä¼˜ç§€ï¼šå¹´åŒ–>15%, å¤æ™®>1.0, å›æ’¤<15%
- âš ï¸ å¯æ¥å—ï¼šå¹´åŒ–>8%, å¤æ™®>0.8, å›æ’¤<20%
- âŒ éœ€è¦æ”¹è¿›ï¼šå¹´åŒ–<5%, å¤æ™®<0.5, å›æ’¤>25%

---

## ğŸš€ è¿è¡Œç¤ºä¾‹

### **ç¤ºä¾‹1ï¼šå¿«é€ŸéªŒè¯**

```bash
# åªç”¨å‰10ä¸ªè‚¡ç¥¨ã€è¿‘1å¹´æ•°æ®æµ‹è¯•é€»è¾‘
cd a-share-agent
source .venv/bin/activate

# ä¿®æ”¹è„šæœ¬å‚æ•°
# run_breadth.py: top_n=10, lookback_days=365
# run_daily.py: top_n=10

python scripts/run_breadth.py    # 1-2åˆ†é’Ÿ
python scripts/run_daily.py      # 30ç§’

# æŸ¥çœ‹è¾“å‡º
cat data/orders_today.csv
```

### **ç¤ºä¾‹2ï¼šå®Œæ•´æµç¨‹**

```bash
# æ ‡å‡†é…ç½®ï¼š100ä¸ªæ ‡çš„ã€2å¹´å†å²
python scripts/run_breadth.py    # 10-30åˆ†é’Ÿï¼ˆé¦–æ¬¡ï¼‰
python scripts/run_daily.py      # 3-5åˆ†é’Ÿ

# ç›‘å¬è¾“å‡º
tail -f data/orders_today.csv
```

### **ç¤ºä¾‹3ï¼šå‚æ•°ä¼˜åŒ–**

```bash
# å›æµ‹æœ€è¿‘1å¹´ï¼Œæµ‹è¯•å‚æ•°ç»„åˆ
python scripts/backtest_analysis.py

# è¾“å‡ºç»©æ•ˆå¯¹æ¯”è¡¨
```

---

## ğŸ“ˆ é¢„æœŸè¡¨ç°

åŸºäº **2022-2024å¹´** å†å²æ•°æ®çš„å‚è€ƒå€¼ï¼ˆä»…ä¾›å‚è€ƒï¼‰ï¼š

| å¸‚åœºé˜¶æ®µ | å¹´åŒ–æ”¶ç›Š | å¤æ™® | å›æ’¤ | è¯´æ˜ |
|---|---|---|---|---|
| ğŸ‚ ç‰›å¸‚ | 25-35% | 1.2-1.5 | 8-12% | ç­–ç•¥æœ€ä¼˜ |
| â¡ï¸ éœ‡è¡å¸‚ | 12-18% | 0.9-1.1 | 12-18% | ç­–ç•¥é€‚åº”æ€§å¼º |
| ğŸ» ç†Šå¸‚ | 5-10% | 0.6-0.8 | 15-25% | é£æ§çº¦æŸç”Ÿæ•ˆ |

**å…³é”®è§‚å¯Ÿï¼š** çŸ­çº¿ç­–ç•¥å¤©ç„¶é€‚åˆä¹°å–åŒæ–¹éƒ½å‚ä¸çš„å¸‚åœºï¼Œç†Šå¸‚æ—¶ä»“ä½è‡ªåŠ¨é™ä½ï¼ˆ20%æœ€å°å€¼ï¼‰

---

## âš™ï¸ å‚æ•°è°ƒä¼˜æŒ‡å—

### **æ¿€è¿›è°ƒæ•´** (è¿½æ±‚é«˜æ”¶ç›Š)
```python
top_n = 150              # å®½æ¾é€‰è‚¡
lookback_days = 365      # å¿«é€Ÿé€‚åº”
momentum_thresh = 0.5    # ä½åŠ¨é‡è¿‡æ»¤
volatility_thresh = 0.9  # æ¥å—é«˜æ³¢åŠ¨
```

### **ä¿å®ˆè°ƒæ•´** (è¿½æ±‚ç¨³å®šæ€§)
```python
top_n = 80               # ä¸¥æ ¼æµåŠ¨æ€§
lookback_days = 365*3    # é•¿æœŸå‚æ•°ç¨³å®š
momentum_thresh = 0.7    # é«˜åŠ¨é‡è¿‡æ»¤
volatility_thresh = 0.7  # æ‹’ç»é«˜æ³¢åŠ¨
```

### **å›æµ‹éªŒè¯æµç¨‹**
1. ä¿®æ”¹å‚æ•° â†’ è¿è¡Œ `run_daily.py`
2. è§‚å¯Ÿ `data/orders_today.csv` æ•°é‡ä¸åˆ†å¸ƒ
3. ç”¨ `backtest_analysis.py` å†å²å›æµ‹
4. å¯¹æ¯”å¤æ™®ã€å›æ’¤ç­‰å…³é”®æŒ‡æ ‡
5. é€‰æ‹©æœ€ä¼˜å‚æ•°ç»„åˆ

---

## ğŸ”— æ¨¡å—ä¾èµ–å…³ç³»

```
dataio.py          # åŸºç¡€å±‚ï¼šæ•°æ®è·å–
  â†“
breadth.py + signals.py + risk.py      # æ ¸å¿ƒå±‚ï¼šæŒ‡æ ‡è®¡ç®—
  â†“
backtest.py        # éªŒè¯å±‚ï¼šå›æµ‹å¼•æ“
  â†“
orders.py          # è¾“å‡ºå±‚ï¼šè®¢å•å¯¼å‡º
```

**å¯¼å…¥ä¾èµ–é“¾ï¼š**
- `run_breadth.py` â†’ dataio, breadth, save_parquet
- `run_daily.py` â†’ dataio, signals, breadth, risk, backtest, orders
- `backtest_analysis.py` â†’ æ‰€æœ‰æ¨¡å—

---

## ğŸ“‹ æ•°æ®æµè½¬è¯¦è§£

### **æ•°æ®æµå‘**
```
akshare API
   â†“
Parquet ç¼“å­˜
   â†“
é¢æ¿ DataFrame (æ—¥æœŸÃ—ä»£ç )
   â†“
   â”œâ”€ breadth.py: è®¡ç®—å¸‚åœºæŒ‡æ ‡
   â”‚  â””â”€ data/market/breadth.parquet
   â”‚
   â””â”€ signals.py: ç”Ÿæˆé€‰è‚¡ä¿¡å·
      â”œâ”€ closes: æ”¶ç›˜ä»·é¢æ¿
      â”œâ”€ entries: bool é¢æ¿ (å…¥åœºä¿¡å·)
      â”œâ”€ exits: bool é¢æ¿ (å‡ºåœºä¿¡å·)
      â””â”€ score: float é¢æ¿ (æ‰“åˆ†)
```

### **æ–‡ä»¶æ ¼å¼**

**breadth.parquet:**
```
æ—¥æœŸç´¢å¼•ï¼Œcolumns: 
  up_count, down_count, total, nh_252, nl_252, limit_up,
  ad_ratio, nh_ratio, nl_ratio, zt_ratio,
  breadth_score, breadth_score_ema, regime
```

**orders_today.csv:**
```
code,name,target_weight,order_type,timestamp
000001,å¹³å®‰é“¶è¡Œ,0.0526,buy,2024-10-31 15:20:00
000858,äº”ç²®æ¶²,0.0526,buy,2024-10-31 15:20:00
```

---

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

| é—®é¢˜ | åŸå›  | è§£å†³ |
|---|---|---|
| æ•°æ®æ‹‰å–å¾ˆæ…¢ | akshare ç½‘ç»œ | å‡å°‘top_næˆ–ä½¿ç”¨VPN |
| æ— è®¢å•è¾“å‡º | ç†Šå¸‚æ‹’ç»æˆ–æ— ä¿¡å· | æ£€æŸ¥breadth_score_emaæˆ–å‚æ•° |
| å›æµ‹ç»“æœå·® | è´¹ç”¨/æ»‘ç‚¹è®¾ç½® | å¢åŠ fees/slippageä¿å®ˆä¼°è®¡ |
| å¯¼å…¥é”™è¯¯ | è™šæ‹Ÿç¯å¢ƒé—®é¢˜ | é‡æ–° source .venv/bin/activate |

---

## ğŸ“ æŠ€æœ¯æ ˆ

| ç»„ä»¶ | ç‰ˆæœ¬ | ç”¨é€” |
|---|---|---|
| Python | 3.9-3.11 | ç¼–ç¨‹è¯­è¨€ |
| akshare | â‰¥1.14.0 | Aè‚¡æ•°æ®æº |
| pandas | â‰¥2.2.0 | æ•°æ®å¤„ç† |
| numpy | â‰¥1.26.0 | æ•°å€¼è®¡ç®— |
| vectorbt | â‰¥0.25.7 | å›æµ‹å¼•æ“(å¯é€‰) |
| scikit-learn | â‰¥1.4.0 | æ•°æ®é¢„å¤„ç† |

---

## ğŸ“„ è®¸å¯è¯

MIT License - å®Œå…¨å¼€æºå…è´¹

---

## âš ï¸ é£é™©æç¤º

1. **å†å²ä¸ä»£è¡¨æœªæ¥** - è¿‡å»è¡¨ç°ä¸ä¿è¯æœªæ¥æ”¶ç›Š
2. **å¸‚åœºé£é™©** - å¯èƒ½é€ æˆæœ¬é‡‘å…¨éƒ¨æŸå¤±
3. **æµåŠ¨æ€§é£é™©** - æç«¯å¸‚åœºä¸‹å¯èƒ½æ— æ³•æˆäº¤
4. **ç³»ç»Ÿé£é™©** - å»ºè®®å°é¢è¯•è·‘éªŒè¯
5. **äº¤æ˜“æˆæœ¬** - çŸ­çº¿è´¹ç‡+æ»‘ç‚¹+ç¨æ”¶ä¸å¯å¿½è§†

**ä½¿ç”¨è€…éœ€è‡ªè¡Œæ‰¿æ‹…æ‰€æœ‰äº¤æ˜“é£é™©ã€‚æœ¬ç³»ç»Ÿä»…ä¾›å­¦ä¹ äº¤æµã€‚**

---

**æ›´æ–°æ—¶é—´ï¼š** 2024-10  
**ç»´æŠ¤è€…ï¼š** Aè‚¡é‡åŒ–äº¤æ˜“ç¤¾åŒº  
**åé¦ˆä¸è®¨è®ºï¼š** GitHub Issues / é‡åŒ–è®ºå›
